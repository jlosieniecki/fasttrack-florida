<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAST Gr3 Acc. | Complete Blueprint Simulator</title>
    <style>
        :root {
            --primary: #004d40;
            --accent: #ff6f00;
            --bg: #eceff1;
            --text: #263238;
            --sel: #e0f2f1;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* SIDEBAR */
        .sidebar { width: 340px; background: white; border-right: 1px solid #cfd8dc; display: flex; flex-direction: column; overflow: hidden; }
        .logo { padding: 20px; background: var(--primary); color: white; }
        .logo h1 { margin: 0; font-size: 1.2rem; }
        
        .sim-btn { margin: 15px; padding: 15px; background: var(--accent); color: white; text-align: center; border-radius: 6px; cursor: pointer; font-weight: bold; border: 2px solid #e65100; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .sim-btn:hover { background: #e65100; }

        .menu { flex: 1; overflow-y: auto; padding: 10px; }
        .cat-header { font-size: 0.75rem; text-transform: uppercase; color: #78909c; font-weight: 800; margin: 20px 0 5px; border-bottom: 2px solid #eee; }
        .std-btn { display: block; width: 100%; text-align: left; padding: 10px; margin-bottom: 4px; background: #fff; border: 1px solid #eee; border-radius: 4px; cursor: pointer; font-size: 0.85rem; }
        .std-btn:hover { background: #f5f5f5; border-color: #aaa; }
        .std-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* MAIN */
        .main { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; }
        .card { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); max-width: 900px; margin: 0 auto; width: 100%; border-top: 5px solid var(--primary); }
        
        .header { display: flex; justify-content: space-between; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .badge { background: #eceff1; padding: 5px 10px; border-radius: 15px; font-weight: bold; font-size: 0.8rem; }
        
        .prompt { font-size: 1.3rem; margin-bottom: 25px; }
        .visual { background: #fafafa; border: 2px dashed #cfd8dc; border-radius: 8px; padding: 20px; margin-bottom: 20px; display: flex; justify-content: center; align-items: center; }

        .options { display: grid; gap: 10px; }
        .opt { display: flex; align-items: center; padding: 15px; border: 2px solid #eee; border-radius: 6px; cursor: pointer; font-size: 1.1rem; }
        .opt:hover { border-color: #b0bec5; background: #fafafa; }
        .opt.selected { border-color: var(--primary); background: var(--sel); }
        
        .icon { width: 20px; height: 20px; border: 2px solid #546e7a; margin-right: 15px; display: flex; justify-content: center; align-items: center; }
        .radio .icon { border-radius: 50%; }
        .check .icon { border-radius: 4px; }
        .selected .radio .icon { background: var(--primary); border-color: var(--primary); }
        .selected .check .icon { background: var(--primary); border-color: var(--primary); }

        .feedback { margin-top: 20px; padding: 15px; border-radius: 6px; display: none; }
        .feedback.correct { background: #e8f5e9; color: #1b5e20; border: 1px solid #a5d6a7; }
        .feedback.wrong { background: #ffebee; color: #b71c1c; border: 1px solid #ef9a9a; }

        .btn-action { margin-top: 20px; padding: 10px 25px; background: var(--primary); color: white; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; float: right; }
        .btn-action:disabled { background: #ccc; cursor: not-allowed; }
        
        .eq-input { padding: 10px; font-size: 1.2rem; width: 100%; border: 2px solid #546e7a; border-radius: 4px; }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="logo">
        <h1>FAST Grade 3 Acc.</h1>
        <p>100% Coverage (33 Standards)</p>
    </div>
    <div class="sim-btn" onclick="App.startSim()">ðŸš€ Start Full Test Sim</div>
    <div class="menu" id="menu"></div>
</div>

<div class="main">
    <div class="card">
        <div class="header">
            <span class="badge" id="badge">Select Standard</span>
            <span id="score">Score: 0</span>
        </div>
        <div class="prompt" id="prompt">Select a standard or start the simulation.</div>
        <div class="visual" id="visual" style="display:none;"></div>
        <div class="options" id="options"></div>
        <div class="feedback" id="feedback"></div>
        <button class="btn-action" id="btn" onclick="App.check()" disabled>Check Answer</button>
    </div>
</div>

<script>
const Utils = {
    rInt: (min, max) => Math.floor(Math.random() * (max - min + 1)) + min,
    pick: (arr) => arr[Math.floor(Math.random() * arr.length)],
    shuffle: (arr) => arr.sort(() => Math.random() - 0.5),
    
    // --- SVG LIBRARY (Enhanced for Geometry) ---
    svg: {
        clock: (h, m) => {
            const hDeg = (h%12)*30 + m*0.5, mDeg = m*6;
            let ticks = Array.from({length:60},(_,i)=>`<line x1="50" y1="6" x2="50" y2="${i%5?7:10}" transform="rotate(${i*6} 50 50)" stroke="#333" stroke-width="${i%5?1:2}"/>`).join('');
            return `<svg width="150" height="150" viewBox="0 0 100 100"><circle cx="50" cy="50" r="48" stroke="#333" stroke-width="2" fill="white"/>${ticks}<line x1="50" y1="50" x2="50" y2="28" stroke="black" stroke-width="3" transform="rotate(${hDeg} 50 50)"/><line x1="50" y1="50" x2="50" y2="15" stroke="red" stroke-width="2" transform="rotate(${mDeg} 50 50)"/><circle cx="50" cy="50" r="3" fill="#333"/></svg>`;
        },
        lines: (type) => { // NEW: For GR.1.1
            const defs = `<defs><marker id="ah" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"><path d="M0,0 L0,6 L9,3 z" fill="#000" /></marker></defs>`;
            if(type==='line') return `<svg width="200" height="50">${defs}<line x1="20" y1="25" x2="180" y2="25" stroke="#000" stroke-width="2" marker-end="url(#ah)" marker-start="url(#ah)"/></svg>`;
            if(type==='ray') return `<svg width="200" height="50">${defs}<circle cx="20" cy="25" r="4" fill="#000"/><line x1="20" y1="25" x2="180" y2="25" stroke="#000" stroke-width="2" marker-end="url(#ah)"/></svg>`;
            if(type==='segment') return `<svg width="200" height="50"><circle cx="20" cy="25" r="4" fill="#000"/><line x1="20" y1="25" x2="180" y2="25" stroke="#000" stroke-width="2"/><circle cx="180" cy="25" r="4" fill="#000"/></svg>`;
            if(type==='perp') return `<svg width="100" height="100"><line x1="50" y1="10" x2="50" y2="90" stroke="#000" stroke-width="2"/><line x1="10" y1="50" x2="90" y2="50" stroke="#000" stroke-width="2"/><rect x="50" y="50" width="10" height="10" fill="none" stroke="#000"/></svg>`;
        },
        fraction: (n,d) => `<svg width="150" height="150" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" stroke="#000" fill="#fff"/><path d="M50 50 L50 5 A45 45 0 ${d==2?0:1} 1 ${50+45*Math.sin(2*Math.PI*n/d)} ${50-45*Math.cos(2*Math.PI*n/d)} Z" fill="#ff6f00" stroke="#000" opacity="${n>0?1:0}"/></svg>`, // Simplified pie
        rect: (w,h) => `<svg width="150" height="100" viewBox="0 0 150 100"><rect x="10" y="10" width="${w*10}" height="${h*10}" fill="#e0f2f1" stroke="#004d40"/><text x="${10+w*5}" y="95" text-anchor="middle">${w}</text><text x="5" y="${10+h*5}" text-anchor="middle">${h}</text></svg>`,
        pictograph: () => `<svg width="200" height="80"><text x="0" y="20">A</text><circle cx="30" cy="15" r="5" fill="orange"/><circle cx="50" cy="15" r="5" fill="orange"/><text x="0" y="50">B</text><circle cx="30" cy="45" r="5" fill="orange"/><text x="80" y="75" font-size="10">Key: O = 2</text></svg>`
    }
};

// --- THE COMPLETE 33-STANDARD BANK ---
const Bank = {
    "Number Sense (NSO)": [
        { id: "MA.3.NSO.1.1", desc: "Read/Write Numbers", gen: () => ({ text: "Select <strong>Expanded Form</strong> for 4,052.", type: 'radio', options: [{t:"4,000 + 50 + 2",c:true},{t:"4,000 + 500 + 2",c:false},{t:"4 + 0 + 5 + 2",c:false}], fb: "Watch place value!" })},
        { id: "MA.3.NSO.1.2", desc: "Compose/Decompose", gen: () => ({ text: "Which is equal to <strong>1,400</strong>?", type: 'radio', options: [{t:"14 hundreds",c:true},{t:"14 tens",c:false},{t:"1 thousand 4 tens",c:false}], fb: "14 hundreds = 1,400." })},
        { id: "MA.3.NSO.1.3", desc: "Compare/Order", gen: () => ({ text: "Select the true statement.", type: 'radio', options: [{t:"4,050 > 4,005",c:true},{t:"3,900 > 3,990",c:false},{t:"1,200 = 1,020",c:false}], fb: "Compare highest place value first." })},
        { id: "MA.3.NSO.1.4", desc: "Rounding", gen: () => { const n=Utils.rInt(100,900); return { text: `Round <strong>${n}</strong> to nearest 100.`, type: 'equation', ans: (Math.round(n/100)*100).toString(), fb: "Round to 100." }}},
        { id: "MA.3.NSO.2.1", desc: "Add/Sub Multi-Digit", gen: () => ({ text: "Solve: <strong>4,200 - 1,150</strong>", type: 'equation', ans: "3050", fb: "Regroup carefully." })},
        { id: "MA.3.NSO.2.2", desc: "Mult Facts 0-144", gen: () => ({ text: "Solve: <strong>12 Ã— 11</strong>", type: 'equation', ans: "132", fb: "12 times 11 is 132." })},
        { id: "MA.3.NSO.2.3", desc: "Mult by 10s", gen: () => ({ text: "Solve: <strong>40 Ã— 6</strong>", type: 'equation', ans: "240", fb: "4x6=24, add zero." })},
        { id: "MA.3.NSO.2.4", desc: "Mult 1d x 2d", gen: () => ({ text: "Solve: <strong>15 Ã— 4</strong>", type: 'equation', ans: "60", fb: "Standard algorithm." })}
    ],
    "Algebra (AR)": [
        { id: "MA.3.AR.1.1", desc: "Distributive Prop", gen: () => ({ text: "Rewrite <strong>7 Ã— 14</strong>", type: 'radio', options: [{t:"(7Ã—10) + (7Ã—4)",c:true},{t:"(7Ã—10) Ã— (7Ã—4)",c:false}], fb: "Split 14 into 10 + 4." })},
        { id: "MA.3.AR.1.2", desc: "Real World x/Ã·", gen: () => ({ text: "Joe has 4 bags. Each has 6 apples. How many apples?", type: 'equation', ans: "24", fb: "4 groups of 6." })},
        { id: "MA.3.AR.2.1", desc: "Div as Missing Factor", gen: () => ({ text: "Restate <strong>24 Ã· 6 = ?</strong>", type: 'radio', options: [{t:"6 Ã— ? = 24",c:true},{t:"24 Ã— 6 = ?",c:false}], fb: "Division is inverse of multiplication." })},
        { id: "MA.3.AR.2.2", desc: "True/False Equations", gen: () => ({ text: "Is this true? <strong>5 Ã— 4 = 10 + 10</strong>", type: 'radio', options: [{t:"True",c:true},{t:"False",c:false}], fb: "20 = 20." })},
        { id: "MA.3.AR.2.3", desc: "Missing Factor", gen: () => ({ text: "<strong>? Ã— 8 = 48</strong>", type: 'equation', ans: "6", fb: "Fact family." })},
        { id: "MA.3.AR.3.1", desc: "Even/Odd", gen: () => { const n=Utils.rInt(10,50); const e=n%2===0; return { text: `Is <strong>${n}</strong> Even or Odd?`, type: 'radio', options: [{t:"Even",c:e},{t:"Odd",c:!e}], fb: "Ends in 0,2,4,6,8 is Even." }}},
        { id: "MA.3.AR.3.2", desc: "Multiples", gen: () => ({ text: "Which is a multiple of 3?", type: 'radio', options: [{t:"12",c:true},{t:"13",c:false},{t:"14",c:false}], fb: "3, 6, 9, 12..." })},
        { id: "MA.3.AR.3.3", desc: "Patterns", gen: () => ({ text: "Rule: Multiply by 5. Input: 4. Output?", type: 'equation', ans: "20", fb: "4 x 5 = 20." })}
    ],
    "Fractions (FR)": [
        { id: "MA.3.FR.1.1", desc: "Visual Fractions", gen: () => ({ text: "Fraction shaded?", visual: Utils.svg.fraction(1,4), type: 'radio', options: [{t:"1/4",c:true},{t:"3/4",c:false}], fb: "1 part out of 4." })},
        { id: "MA.3.FR.1.2", desc: "Represent 1", gen: () => ({ text: "Which equals 1?", type: 'radio', options: [{t:"4/4",c:true},{t:"4/1",c:false}], fb: "Num = Denom." })},
        { id: "MA.3.FR.1.3", desc: "Read/Write Frac", gen: () => ({ text: "Word form of 2/3?", type: 'radio', options: [{t:"Two-thirds",c:true},{t:"Three-halves",c:false}], fb: "Numerator first." })},
        { id: "MA.3.FR.2.1", desc: "Compare Fractions", gen: () => ({ text: "Compare:", type: 'radio', options: [{t:"1/3 > 1/4",c:true},{t:"1/3 < 1/4",c:false}], fb: "Smaller denominator = bigger pieces." })},
        { id: "MA.3.FR.2.2", desc: "Equivalence", gen: () => ({ text: "Select fractions equal to 1/2.", type: 'multi', options: [{t:"2/4",c:true},{t:"3/6",c:true},{t:"1/3",c:false}], fb: "Multiply num/den by same number." })}
    ],
    "Geometry (GR)": [
        { id: "MA.3.GR.1.1", desc: "Points/Lines (NEW)", gen: () => ({ text: "Identify this figure (arrows on both ends).", visual: Utils.svg.lines('line'), type: 'radio', options: [{t:"Line",c:true},{t:"Ray",c:false},{t:"Segment",c:false}], fb: "Lines go forever both ways." })},
        { id: "MA.3.GR.1.2", desc: "Attributes", gen: () => ({ text: "Select shapes with 4 right angles.", type: 'multi', options: [{t:"Square",c:true},{t:"Rectangle",c:true},{t:"Rhombus",c:false}], fb: "Rectangles/Squares." })},
        { id: "MA.3.GR.1.3", desc: "Symmetry", gen: () => ({ text: "Is the line symmetric?", type: 'radio', options: [{t:"Yes",c:true},{t:"No",c:false}], fb: "Mirror image." })},
        { id: "MA.3.GR.2.1", desc: "Area", gen: () => ({ text: "Area of 5x6 rect?", type: 'equation', ans: "30", fb: "L x W." })},
        { id: "MA.3.GR.2.2", desc: "Area Distributive", gen: () => ({ text: "Split 5x12 into:", type: 'radio', options: [{t:"(5x10)+(5x2)",c:true},{t:"(5x5)+(5x5)",c:false}], fb: "Break apart length." })},
        { id: "MA.3.GR.2.3", desc: "Perimeter", gen: () => ({ text: "Perimeter of 5x3 rect?", type: 'equation', ans: "16", fb: "5+5+3+3." })},
        { id: "MA.3.GR.2.4", desc: "Composite Area", gen: () => ({ text: "Area of L-shape (4x4 + 2x2)?", type: 'equation', ans: "20", fb: "Sum of parts." })}
    ],
    "Measurement (M)": [
        { id: "MA.3.M.1.1", desc: "Meas. Tools", gen: () => ({ text: "Best tool to measure water in a pool?", type: 'radio', options: [{t:"Gallons",c:true},{t:"Cups",c:false},{t:"Inches",c:false}], fb: "Large volume = Gallons." })},
        { id: "MA.3.M.1.2", desc: "Meas. Problems", gen: () => ({ text: "A box is 5kg. Two boxes?", type: 'equation', ans: "10", fb: "5+5." })},
        { id: "MA.3.M.2.1", desc: "Time (Minute)", gen: () => ({ text: "Time shown?", visual: Utils.svg.clock(3,15), type: 'radio', options: [{t:"3:15",c:true},{t:"3:03",c:false}], fb: "Short hand hour, long hand minute." })},
        { id: "MA.3.M.2.2", desc: "Elapsed Time", gen: () => ({ text: "2:00 to 2:45 is how long?", type: 'radio', options: [{t:"45 min",c:true},{t:"30 min",c:false}], fb: "Count minutes." })}
    ],
    "Data (DP)": [
        { id: "MA.3.DP.1.1", desc: "Read Graphs", gen: () => ({ text: "How many A (2) and B (1)? Key: O=2", visual: Utils.svg.pictograph(), type: 'equation', ans: "6", fb: "A(4) + B(2) = 6." })},
        { id: "MA.3.DP.1.2", desc: "Interpret Data", gen: () => ({ text: "If 5 more vote A (currently 4), new total?", visual: Utils.svg.pictograph(), type: 'equation', ans: "9", fb: "4+5=9." })}
    ]
};

const App = {
    mode: 'practice', currQ: null, score: 0,
    init: function() {
        const m = document.getElementById('menu');
        for(const cat in Bank) {
            const h = document.createElement('div'); h.className='cat-header'; h.innerText=cat; m.appendChild(h);
            Bank[cat].forEach(s => {
                const b = document.createElement('div'); b.className='std-btn'; b.innerHTML=`<strong>${s.id}</strong><br>${s.desc}`;
                b.onclick = () => App.load(s); m.appendChild(b);
            });
        }
    },
    startSim: function() { this.mode='sim'; this.score=0; document.getElementById('badge').innerText="Test Simulation"; this.nextSim(); },
    nextSim: function() { const all=[]; for(const c in Bank) Bank[c].forEach(s=>all.push(s)); App.load(Utils.pick(all)); },
    load: function(s) {
        this.currStd=s; this.currQ=s.gen(); const q=this.currQ;
        document.getElementById('prompt').innerHTML=q.text;
        document.getElementById('badge').innerText = this.mode==='sim'?"Sim Mode":s.id;
        const v = document.getElementById('visual'); v.innerHTML=q.visual||''; v.style.display=q.visual?'flex':'none';
        const opts = document.getElementById('options'); opts.innerHTML='';
        const btn = document.getElementById('btn'); btn.innerText="Check"; btn.disabled=true; btn.onclick=()=>App.check();
        document.getElementById('feedback').style.display='none';

        if(q.type==='radio'||q.type==='multi') {
            q.options.forEach((o,i)=>{
                const el=document.createElement('div'); el.className=`opt ${q.type}`;
                el.innerHTML=`<div class="icon"></div> ${o.t}`;
                el.onclick=()=>{
                    if(q.type==='radio'){document.querySelectorAll('.opt').forEach(x=>x.classList.remove('selected')); el.classList.add('selected'); App.sel=i;}
                    else el.classList.toggle('selected');
                    btn.disabled=false;
                };
                opts.appendChild(el);
            });
        } else {
            opts.innerHTML=`<input id="inp" class="eq-input" placeholder="Answer...">`;
            setTimeout(()=>document.getElementById('inp').oninput=e=>btn.disabled=e.target.value==='',0);
        }
    },
    check: function() {
        const q=this.currQ; let ok=false;
        if(q.type==='radio') ok=q.options[App.sel].c;
        if(q.type==='multi') {
            const s=[], c=q.options.map((o,i)=>o.c?i:null).filter(x=>x!==null);
            document.querySelectorAll('.opt').forEach((b,i)=>{if(b.classList.contains('selected'))s.push(i)});
            if(s.length===c.length && s.every(v=>c.includes(v))) ok=true;
        }
        if(q.type==='equation') ok=document.getElementById('inp').value.trim()===q.ans;

        const fb=document.getElementById('feedback'); fb.style.display='block'; fb.className=`feedback ${ok?'correct':'wrong'}`;
        fb.innerHTML=`<strong>${ok?'Correct!':'Incorrect'}</strong><br>${q.fb}`;
        if(ok) document.getElementById('score').innerText=`Score: ${++this.score}`;
        const btn=document.getElementById('btn'); btn.innerText="Next"; btn.onclick=()=>this.mode==='sim'?this.nextSim():this.load(this.currStd);
    }
};
App.init();
</script>
</body>
</html>
