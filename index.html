<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastTrack Florida: Assessment Pro</title>
    <style>
        :root { --primary: #00796B; --bg: #f4f7f7; --fast-blue: #2196F3; --selected: #e3f2fd; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        
        /* LAYOUT */
        .card { background: white; width: 100%; max-width: 600px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 20px; box-sizing: border-box; border-top: 8px solid var(--primary); }
        .header { display: flex; justify-content: space-between; margin-bottom: 15px; font-weight: bold; color: #555; }
        .q-text { font-size: 1.15em; margin-bottom: 20px; line-height: 1.5; }
        
        /* MATCHING GRID (Table) */
        .match-table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        .match-table th, .match-table td { border: 1px solid #ddd; padding: 12px; text-align: center; font-size: 1em; }
        .match-table th { background: #f8f9fa; color: #444; }
        .check-box { width: 25px; height: 25px; cursor: pointer; accent-color: var(--primary); }

        /* FRACTION MODEL (Interactive Shading) */
        .fraction-container { display: flex; gap: 10px; justify-content: center; margin: 20px 0; }
        .frac-part { width: 50px; height: 50px; border: 2px solid #333; background: white; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #aaa; }
        .frac-part.shaded { background: var(--fast-blue); color: white; border-color: var(--fast-blue); }

        /* GRAPHING (Interactive Bars) */
        .chart-container { display: flex; align-items: flex-end; justify-content: space-around; height: 200px; border-bottom: 2px solid #333; padding-bottom: 5px; margin-top: 20px; }
        .bar-group { display: flex; flex-direction: column; align-items: center; width: 40px; }
        .bar { width: 100%; background: #ddd; transition: 0.3s; cursor: pointer; border-radius: 5px 5px 0 0; position: relative; }
        .bar:hover { background: #ccc; }
        .bar.active { background: var(--primary); }
        .bar-label { margin-top: 5px; font-size: 0.8em; font-weight: bold; }
        .bar-val { font-size: 0.8em; margin-bottom: 3px; }

        /* EDITING TASK (Dropdowns) */
        .inline-select { font-size: 1em; padding: 5px; border: 2px solid var(--primary); border-radius: 5px; background: white; cursor: pointer; margin: 0 4px; }

        /* BUTTONS */
        .submit-btn { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 10px; font-weight: bold; width: 100%; font-size: 1.1em; cursor: pointer; margin-top: 20px; }
        .nav-btn { background: #ddd; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px; font-size: 0.9em; }

        #feedback { margin-top: 15px; font-weight: bold; text-align: center; min-height: 25px; }
    </style>
</head>
<body>

    <img src="Gemini_Generated_Image_t8043ht8043ht804.png" style="width:60px; border-radius:10px; margin-bottom:10px;">

    <div class="card">
        <div class="header">
            <span>Question <span id="q-num">1</span></span>
            <span>üèÜ Score: <span id="score">0</span></span>
        </div>

        <div id="q-area" class="q-text">Loading...</div>
        <div id="interaction-area"></div>
        
        <button id="submit" class="submit-btn" onclick="checkAnswer()">Submit Response</button>
        <div id="feedback"></div>
    </div>

    <script>
        let state = { score: 0, qNum: 1 };
        let curQ = {};

        const engines = [
            // 1. MATCHING ITEM (MA.3.NSO.2.4 - Division/Multiplication Facts)
            function() {
                const rows = [
                    { q: "4 √ó 3", a: 12 },
                    { q: "12 √∑ 2", a: 6 },
                    { q: "15 √∑ 3", a: 5 }
                ];
                const cols = [5, 6, 12]; // The headers
                
                let html = `<table class="match-table"><thead><tr><th>Expression</th>`;
                cols.forEach(c => html += `<th>${c}</th>`);
                html += `</tr></thead><tbody>`;
                
                rows.forEach((r, i) => {
                    html += `<tr><td><b>${r.q}</b></td>`;
                    cols.forEach((c, j) => {
                        html += `<td><input type="checkbox" class="check-box" data-row="${i}" data-val="${c}"></td>`;
                    });
                    html += `</tr>`;
                });
                html += `</tbody></table>`;

                return {
                    type: "matching",
                    std: "MA.3.NSO.2.4",
                    q: "Match each expression to its correct value by checking the box.",
                    html: html,
                    correctRows: rows // We will check logic in checkAnswer
                };
            },

            // 2. FRACTION MODEL (MA.3.FR.1.1 - Partitioning)
            function() {
                let d = [3, 4, 6, 8][Math.floor(Math.random() * 4)];
                let target = Math.floor(Math.random() * (d - 1)) + 1; // e.g., Shade 3 of 4
                
                let html = `<div class="fraction-container">`;
                for(let i=0; i<d; i++) {
                    html += `<div class="frac-part" onclick="this.classList.toggle('shaded')">1/${d}</div>`;
                }
                html += `</div>`;

                return {
                    type: "fraction",
                    std: "MA.3.FR.1.1",
                    q: `Click parts of the model to shade <b>${target}/${d}</b> of the rectangle.`,
                    html: html,
                    target: target
                };
            },

            // 3. GRAPHING ITEM (MA.3.DP.1.1 - Bar Graphs)
            function() {
                const data = [
                    { label: "Apples", val: Math.floor(Math.random()*8)+2 },
                    { label: "Bananas", val: Math.floor(Math.random()*8)+2 },
                    { label: "Grapes", val: Math.floor(Math.random()*8)+2 }
                ];
                
                let html = `<div class="chart-container">`;
                data.forEach((d, i) => {
                    html += `
                    <div class="bar-group">
                        <div class="bar-val" id="val-${i}">0</div>
                        <div class="bar" style="height: 10px;" onclick="adjustBar(this, ${i})"></div>
                        <div class="bar-label">${d.label}</div>
                    </div>`;
                });
                html += `</div><p style="font-size:0.9em; text-align:center; color:#666;">(Tap bars to raise them)</p>`;

                return {
                    type: "graph",
                    std: "MA.3.DP.1.1",
                    q: `Create a bar graph to show: <br> <b>${data[0].val} Apples, ${data[1].val} Bananas, ${data[2].val} Grapes</b>.`,
                    html: html,
                    data: data
                };
            },

            // 4. EDITING TASK (MA.3.NSO.2.2 - Logic)
            function() {
                let a = 5, b = 4;
                return {
                    type: "editing",
                    std: "MA.3.NSO.2.2",
                    q: "Complete the sentence to describe the array.",
                    html: `
                        The array has <select id="s1" class="inline-select"><option>?</option><option>4</option><option>5</option></select> rows 
                        and <select id="s2" class="inline-select"><option>?</option><option>4</option><option>5</option></select> columns. 
                        The total is <select id="s3" class="inline-select"><option>?</option><option>9</option><option>20</option></select>.
                    `,
                    correct: ["5", "4", "20"]
                };
            }
        ];

        // --- GLOBAL HELPERS ---
        function adjustBar(bar, index) {
            let currentH = parseInt(bar.style.height) || 10;
            let newVal = currentH + 20;
            if (newVal > 180) newVal = 10; // Reset if too high
            
            bar.style.height = newVal + "px";
            // Rough conversion: 20px = 1 unit for simplicity in this demo
            let unitVal = Math.floor((newVal - 10) / 20);
            document.getElementById(`val-${index}`).innerText = unitVal;
            bar.dataset.value = unitVal;
            bar.classList.add('active');
        }

        function next() {
            document.getElementById('score').innerText = state.score;
            document.getElementById('q-num').innerText = state.qNum;
            document.getElementById('feedback').innerText = "";

            curQ = engines[Math.floor(Math.random() * engines.length)]();
            document.getElementById('q-area').innerHTML = curQ.q;
            document.getElementById('interaction-area').innerHTML = curQ.html;
        }

        function checkAnswer() {
            let isCorrect = false;

            if (curQ.type === "matching") {
                // Check if every row has exactly the correct box checked
                let allRight = true;
                curQ.correctRows.forEach((row, i) => {
                    let checked = document.querySelector(`.check-box[data-row="${i}"]:checked`);
                    if (!checked || parseInt(checked.dataset.val) !== row.a) allRight = false;
                });
                isCorrect = allRight;
            } 
            else if (curQ.type === "fraction") {
                let shadedCount = document.querySelectorAll('.frac-part.shaded').length;
                isCorrect = (shadedCount === curQ.target);
            }
            else if (curQ.type === "graph") {
                let allRight = true;
                curQ.data.forEach((d, i) => {
                    let userVal = parseInt(document.getElementById(`val-${i}`).innerText) || 0;
                    if (userVal !== d.val) allRight = false;
                });
                isCorrect = allRight;
            }
            else if (curQ.type === "editing") {
                let s1 = document.getElementById('s1').value;
                let s2 = document.getElementById('s2').value;
                let s3 = document.getElementById('s3').value;
                isCorrect = (s1 === curQ.correct[0] && s2 === curQ.correct[1] && s3 === curQ.correct[2]);
            }

            if (isCorrect) {
                state.score += 10;
                document.getElementById('feedback').innerHTML = "<span style='color:green'>Correct! üêä</span>";
                setTimeout(() => { state.qNum++; next(); }, 1500);
            } else {
                document.getElementById('feedback').innerHTML = "<span style='color:orange'>Try again! Check your work.</span>";
            }
        }

        window.onload = next;
    </script>
</body>
</html>
