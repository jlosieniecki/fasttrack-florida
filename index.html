<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Florida FAST B.E.S.T. Simulator 4.0</title>
    <style>
        :root { --fast-blue: #005ea2; --fast-hover: #e1f3f8; --fast-grey: #f0f0f0; }
        body { font-family: 'Verdana', sans-serif; margin: 0; background: #f4f7f6; color: #222; }
        
        /* Dashboard */
        #dashboard { max-width: 1100px; margin: 0 auto; padding: 40px 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; }
        .card { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); cursor: pointer; border-top: 6px solid #ccc; transition: 0.2s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0,0,0,0.15); }
        .card.nso { border-top-color: #005ea2; } .card.fr { border-top-color: #5cb85c; } .card.ar { border-top-color: #f0ad4e; } .card.gr { border-top-color: #6f42c1; }

        /* Simulator */
        #simulator-view { display: none; min-height: 100vh; background: #f2f2f2; }
        #question-card { max-width: 950px; margin: 0 auto; padding: 50px; background: white; border-left: 1px solid #ccc; border-right: 1px solid #ccc; min-height: 600px; padding-bottom: 120px; }
        .question-stem { font-size: 20px; line-height: 1.6; margin-bottom: 20px; font-weight: 500; }
        .std-tag { font-size: 11px; color: #777; margin-bottom: 5px; font-weight: bold; }

        /* Tech Enhanced */
        .option-row { padding: 15px; border: 1px solid #ccc; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center; border-radius: 4px; font-size: 17px; background: white; }
        .option-row:hover { background: var(--fast-hover); border-color: var(--fast-blue); }
        .hot-spot { display: inline-block; padding: 8px 15px; margin: 5px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; background: #f9f9f9; }
        .hot-spot.selected { background: var(--fast-blue); color: white; border-color: var(--fast-blue); }
        
        /* Visuals */
        .visual-container { text-align: center; margin: 25px 0; padding: 15px; border: 1px solid #eee; background: #fff; }
        
        /* Navigation */
        .fast-footer { position: fixed; bottom: 0; width: 100%; height: 75px; background: #e6e6e6; border-top: 1px solid #bbb; display: flex; justify-content: space-between; align-items: center; padding: 0 40px; box-sizing: border-box; }
        .nav-btn { font-size: 16px; padding: 10px 25px; border-radius: 4px; cursor: pointer; border: 1px solid #999; background: white; font-weight: bold; }
        .btn-next { background: var(--fast-blue); color: white; border: none; }
    </style>
</head>
<body>

    <div id="dashboard">
        <div style="text-align:center; margin-bottom:40px;">
            <h1>Florida FAST B.E.S.T. Training Portal</h1>
            <p>Rigorous, High-Complexity Level 3-5 Practice</p>
        </div>
        <div class="grid">
            <div class="card nso" onclick="startTest('NSO')"><h3>Number Sense (NSO)</h3><p>25 Questions • Place Value, Multi-Digit Ops, Flexible Base-10.</p></div>
            <div class="card fr" onclick="startTest('FR')"><h3>Fractions (FR)</h3><p>25 Questions • Equivalence, Number Lines, Comparisons.</p></div>
            <div class="card ar" onclick="startTest('AR')"><h3>Algebraic Reasoning (AR)</h3><p>25 Questions • Multi-step Problems, Distributive Property, Patterns.</p></div>
            <div class="card gr" onclick="startTest('GR')"><h3>Measurement & Geometry (GR/M)</h3><p>25 Questions • Area/Perimeter, Time, Line Plots, Volume.</p></div>
        </div>
    </div>

    <div id="simulator-view">
        <div id="question-card"></div>
        <div class="fast-footer">
            <button class="nav-btn" onclick="location.reload()">Exit</button>
            <div style="font-weight:bold;">Question <span id="q-num">1</span> of <span id="q-total">25</span></div>
            <button class="nav-btn btn-next" onclick="nextQuestion()">Next</button>
        </div>
    </div>

    <script>
        let currentQuestions = [];
        let currentIndex = 0;

        // --- AUTHENTIC VISUAL GENERATORS ---
        function drawClock(h, m) {
            const hDeg = (h % 12) * 30 + (m * 0.5);
            const mDeg = m * 6;
            return `<svg width="160" height="160" viewBox="0 0 200 200"><circle cx="100" cy="100" r="95" fill="white" stroke="black" stroke-width="3"/><circle cx="100" cy="100" r="4"/><line x1="100" y1="100" x2="100" y2="55" stroke="black" stroke-width="6" transform="rotate(${hDeg} 100 100)"/><line x1="100" y1="100" x2="100" y2="30" stroke="black" stroke-width="3" transform="rotate(${mDeg} 100 100)"/></svg>`;
        }

        function drawRuler(val) {
            const width = val * 50;
            return `<svg width="350" height="80" viewBox="0 0 400 100">
                <rect x="10" y="40" width="${width}" height="15" fill="#f0ad4e" stroke="black"/>
                <rect x="10" y="60" width="380" height="30" fill="white" stroke="black"/>
                ${Array.from({length:9}).map((_,i) => `<line x1="${10+i*50}" y1="60" x2="${10+i*50}" y2="75" stroke="black"/><text x="${8+i*50}" y="95" font-size="12">${i}</text>`).join('')}
            </svg>`;
        }

        // --- DYNAMIC GENERATORS (Word form engine) ---
        function nToW(n) {
            const o = ["","one","two","three","four","five","six","seven","eight","nine"];
            const t = ["ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"];
            const ty = ["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"];
            if(n===0) return "zero";
            let s = "";
            if(n>=1000){ s += o[Math.floor(n/1000)] + " thousand "; n%=1000; }
            if(n>=100){ s += o[Math.floor(n/100)] + " hundred "; n%=100; }
            if(n>=20){ s += ty[Math.floor(n/10)] + (n%10?"-"+o[n%10]:"") + " "; n=0; }
            if(n>=10){ s += t[n-10] + " "; n=0; }
            if(n>0) s += o[n];
            return s.trim();
        }

        // --- QUESTION BANK ---
        const NSO_POOL = [
            () => { 
                const n = Math.floor(Math.random()*8000)+1000;
                return { std:'MA.3.NSO.1.1', type:'mc', text:`Select the <b>Word Form</b> for ${n.toLocaleString()}.`, options:[nToW(n), nToW(n+100), nToW(n+10), nToW(n-100)] };
            },
            () => {
                const h = Math.floor(Math.random()*7)+12; // e.g. 14 hundreds
                const total = h * 100;
                return { std:'MA.3.NSO.1.1', type:'multi', text:`Which of the following are equal to <b>${total.toLocaleString()}</b>? Select ALL that apply.`, options:[`${h} hundreds`, `${h*10} tens`, `${Math.floor(h/10)} thousand and ${h%10} hundreds`, `${h} tens`] };
            },
            () => {
                const a = Math.floor(Math.random()*400)+500;
                const b = Math.floor(Math.random()*200)+100;
                return { std:'MA.3.NSO.2.1', type:'mc', text:`Solve using the standard algorithm: ${a} - ${b}`, options:[a-b, a-b+10, a-b-10, a-b+100] };
            }
        ];

        const AR_POOL = [
            () => {
                const p = Math.floor(Math.random()*5)+4; // bags
                const q = Math.floor(Math.random()*3)+6; // items
                return { std:'MA.3.AR.1.2', type:'mc', text:`Sarah has ${p} bags with ${q} marbles in each. She gives 5 marbles to a friend. Which equation shows how many marbles she has now?`, options:[`(${p} × ${q}) - 5`, `(${p} + ${q}) - 5`, `${p} × ${q} × 5`, `(${p} × ${q}) + 5`] };
            },
            () => {
                return { std:'MA.3.AR.2.2', type:'mc', text:`Which equation is FALSE?`, options:['12 ÷ 3 = 2 × 3', '4 × 6 = 24', '15 ÷ 5 = 3', '8 × 2 = 4 × 4'] };
            }
        ];

        const GR_POOL = [
            () => {
                const h = Math.floor(Math.random()*11)+1;
                const m = Math.floor(Math.random()*59);
                return { std:'MA.3.M.2.1', type:'mc', text:`What time is shown on the clock?`, visual: drawClock(h, m), options:[`${h}:${m<10?'0'+m:m}`, `${h==12?1:h+1}:${m<10?'0'+m:m}`, `${m}:${h}`, `${h}:00`] };
            },
            () => {
                const len = (Math.floor(Math.random()*12)+4)/4; // Quarter inch intervals
                return { std:'MA.3.M.1.1', type:'mc', text:`Measure the object to the nearest <b>quarter-inch</b>.`, visual: drawRuler(len), options:[`${len} inches`, `${len+0.25} inches`, `${len-0.25} inches`, `${len+1} inches`] };
            }
        ];

        const FR_POOL = [
            () => {
                return { std:'MA.3.FR.2.1', type:'mc', text:`Which comparison is true?`, options:['1/3 > 1/4', '1/3 < 1/4', '2/6 = 2/3', '1/2 < 1/8'] };
            }
        ];

        // --- CORE ENGINE ---
        function startTest(domain) {
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('simulator-view').style.display = 'block';
            currentQuestions = [];
            
            let pool = [];
            if(domain==='NSO') pool = NSO_POOL;
            else if(domain==='FR') pool = FR_POOL;
            else if(domain==='AR') pool = AR_POOL;
            else if(domain==='GR') pool = GR_POOL;

            for(let i=0; i<25; i++) {
                const gen = pool[i % pool.length];
                currentQuestions.push(gen());
            }
            renderQuestion(0);
        }

        function renderQuestion(index) {
            currentIndex = index;
            const q = currentQuestions[index];
            const container = document.getElementById('question-card');
            document.getElementById('q-num').innerText = index + 1;
            document.getElementById('q-total').innerText = currentQuestions.length;

            let html = `<div class="std-tag">${q.std}</div><div class="question-stem">${q.text}</div>`;
            if(q.visual) html += `<div class="visual-container">${q.visual}</div>`;
            
            const shuffled = [...q.options].sort(() => Math.random() - 0.5);
            html += shuffled.map(o => `<div class="option-row" onclick="handleSelect(this)"><input type="${q.type==='multi'?'checkbox':'radio'}" name="q" style="margin-right:15px;"> ${o}</div>`).join('');
            
            container.innerHTML = html;
        }

        function handleSelect(el) {
            const input = el.querySelector('input');
            if(input.type==='radio'){
                document.querySelectorAll('.option-row').forEach(r => {r.style.background='white'; r.style.borderColor='#ccc';});
                input.checked = true;
            } else {
                input.checked = !input.checked;
            }
            if(input.checked){ el.style.background='var(--fast-hover)'; el.style.borderColor='var(--fast-blue)'; }
            else { el.style.background='white'; el.style.borderColor='#ccc'; }
        }

        function nextQuestion() {
            if(currentIndex < currentQuestions.length - 1) renderQuestion(++currentIndex);
            else {
                document.getElementById('question-card').innerHTML = `<div style="text-align:center;"><h2>Test Submitted</h2><button class="nav-btn btn-next" onclick="location.reload()">Return Home</button></div>`;
            }
        }
    </script>
</body>
</html>
