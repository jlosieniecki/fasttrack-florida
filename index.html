<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastTrack Florida: Official Simulator</title>
    <style>
        :root { --primary: #005696; --bg: #F0F4F8; --fast-blue: #0076D6; --level-green: #4CAF50; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        
        /* LAYOUT */
        .card { background: white; width: 100%; max-width: 650px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 30px; box-sizing: border-box; border-top: 6px solid var(--primary); }
        .header { display: flex; justify-content: space-between; border-bottom: 2px solid #eee; padding-bottom: 15px; margin-bottom: 20px; }
        .score-box { text-align: right; }
        .scale-score { font-size: 1.4em; font-weight: bold; color: var(--primary); }
        .level-badge { background: #eee; padding: 4px 12px; border-radius: 12px; font-size: 0.85em; font-weight: bold; color: #555; display: inline-block; margin-top: 5px; }
        
        /* LEVEL COLORS */
        .lvl-1 { background: #FFCDD2; color: #C62828; }
        .lvl-2 { background: #FFE0B2; color: #EF6C00; }
        .lvl-3 { background: #FFF9C4; color: #FBC02D; }
        .lvl-4 { background: #C8E6C9; color: #2E7D32; }
        .lvl-5 { background: #B2EBF2; color: #00838F; }

        .q-text { font-size: 1.2em; margin-bottom: 25px; line-height: 1.6; color: #222; }

        /* INTERACTION TYPES */
        .match-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .match-table th, .match-table td { border: 1px solid #ccc; padding: 12px; text-align: center; }
        .match-table th { background: #f1f1f1; }
        
        .opt-btn { display: block; width: 100%; padding: 18px; margin-bottom: 12px; border: 2px solid #e0e0e0; border-radius: 6px; background: white; text-align: left; cursor: pointer; font-size: 1.05em; transition: 0.2s; }
        .opt-btn:hover { background: #f9f9f9; border-color: #bbb; }
        .opt-btn.selected { border-color: var(--fast-blue); background: #E3F2FD; font-weight: 600; border-width: 2px; }

        .submit-btn { background: var(--primary); color: white; border: none; padding: 16px; border-radius: 6px; font-weight: bold; width: 100%; font-size: 1.1em; cursor: pointer; margin-top: 25px; }
        .submit-btn:hover { background: #00447a; }

        #feedback { margin-top: 20px; font-weight: bold; text-align: center; min-height: 25px; font-size: 1.1em; }
    </style>
</head>
<body>

    <img src="Gemini_Generated_Image_t8043ht8043ht804.png" style="width:60px; margin-bottom:15px; border-radius: 8px;">

    <div class="card">
        <div class="header">
            <div>
                <div style="font-size:0.85em; color:#666; font-weight:bold; text-transform:uppercase;">FAST Mathematics Grade 3</div>
                <div id="std" style="font-weight:bold; margin-top:5px;">Loading...</div>
            </div>
            <div class="score-box">
                <div id="ss" class="scale-score">SS: 240</div>
                <div id="al" class="level-badge lvl-1">Level 1</div>
            </div>
        </div>

        <div id="q-area" class="q-text"></div>
        <div id="interaction-area"></div>
        
        <button id="submit" class="submit-btn" onclick="checkAnswer()">Submit</button>
        <div id="feedback"></div>
    </div>

    <script>
        // FAST SCALE SCORE RANGES (Grade 3 Math)
        // Level 1: 240-284 | Level 2: 285-296 | Level 3: 297-310 | Level 4: 311-326 | Level 5: 327-360
        let currentSS = 240; // Starting lowest score
        let curQ = {};
        let lastIdx = -1;

        const engines = [
            // 1. TABLE MATCH (MA.3.AR.2.3 - Multiplication Logic)
            function() {
                const rows = [
                    { q: "5 × ? = 30", a: 6 },
                    { q: "40 ÷ ? = 5", a: 8 },
                    { q: "? × 7 = 35", a: 5 }
                ];
                const cols = [5, 6, 8];
                
                let html = `<table class="match-table"><thead><tr><th>Equation</th>`;
                cols.forEach(c => html += `<th>${c}</th>`);
                html += `</tr></thead><tbody>`;
                rows.forEach((r, i) => {
                    html += `<tr><td>${r.q}</td>`;
                    cols.forEach(c => {
                        html += `<td><input type="radio" name="r${i}" value="${c}"></td>`;
                    });
                    html += `</tr>`;
                });
                html += `</tbody></table>`;
                
                return {
                    type: "table", std: "MA.3.AR.2.3",
                    q: "For each equation, select the value that makes it true.",
                    html: html,
                    rows: rows
                };
            },
            // 2. MULTI-SELECT (MA.3.NSO.1.2 - Decomposing)
            function() {
                const n = 3400 + Math.floor(Math.random()*9)*10 + Math.floor(Math.random()*9);
                const opt1 = `${Math.floor(n/1000)*1000} + ${Math.floor((n%1000)/10)*10} + ${n%10}`; // Standard exp
                const opt2 = `${Math.floor(n/100)} hundreds + ${n%100} ones`; // Regrouped
                const wrong = `${Math.floor(n/1000)} thousands + ${n%100} ones`; // Missing tens
                return {
                    type: "multi", std: "MA.3.NSO.1.2",
                    q: `Select <b>two</b> ways to represent the number <b>${n}</b>.`,
                    opts: [opt1, opt2, wrong, `${n} + 10`].sort(() => Math.random() - 0.5),
                    ans: [opt1, opt2]
                };
            },
            // 3. EDITING TASK (MA.3.FR.2.1 - Fractions)
            function() {
                let d1 = 4, d2 = 8;
                return {
                    type: "editing", std: "MA.3.FR.2.1",
                    q: "Complete the comparison sentence.",
                    html: `
                        The fraction 1/${d1} is <select id="s1"><option>?</option><option>greater than</option><option>less than</option></select> 
                        1/${d2} because 1/${d1} has a <select id="s2"><option>?</option><option>larger</option><option>smaller</option></select> denominator.
                    `,
                    ans: ["greater than", "smaller"]
                };
            }
        ];

        function next() {
            let idx; do { idx = Math.floor(Math.random()*engines.length); } while(idx === lastIdx);
            lastIdx = idx; curQ = engines[idx]();
            
            document.getElementById('std').innerText = curQ.std;
            document.getElementById('q-area').innerHTML = curQ.q;
            const area = document.getElementById('interaction-area');
            area.innerHTML = curQ.html || "";
            
            if(curQ.type === "multi") {
                curQ.opts.forEach(o => {
                    area.innerHTML += `<button class="opt-btn" onclick="this.classList.toggle('selected')">${o}</button>`;
                });
            }
            document.getElementById('feedback').innerText = "";
        }

        function updateScore(isCorrect) {
            if(isCorrect) {
                currentSS += 10; // Growth
                if(currentSS > 360) currentSS = 360;
                document.getElementById('feedback').innerHTML = "<span style='color:#2E7D32'>Correct! Score +10</span>";
            } else {
                currentSS -= 5; // Slight drop for rigor
                if(currentSS < 240) currentSS = 240;
                document.getElementById('feedback').innerHTML = "<span style='color:#C62828'>Incorrect. Score -5</span>";
            }

            // Determine Level
            let lvl = 1;
            let colorClass = "lvl-1";
            if(currentSS >= 285) { lvl = 2; colorClass = "lvl-2"; }
            if(currentSS >= 297) { lvl = 3; colorClass = "lvl-3"; }
            if(currentSS >= 311) { lvl = 4; colorClass = "lvl-4"; }
            if(currentSS >= 327) { lvl = 5; colorClass = "lvl-5"; }

            document.getElementById('ss').innerText = "SS: " + currentSS;
            const badge = document.getElementById('al');
            badge.innerText = "Level " + lvl;
            badge.className = "level-badge " + colorClass;
        }

        function checkAnswer() {
            let correct = false;
            if(curQ.type === "table") {
                let allRows = true;
                curQ.rows.forEach((r, i) => {
                    let val = document.querySelector(`input[name="r${i}"]:checked`)?.value;
                    if(parseInt(val) !== r.a) allRows = false;
                });
                correct = allRows;
            } else if(curQ.type === "multi") {
                let sel = Array.from(document.querySelectorAll('.opt-btn.selected')).map(b => b.innerText);
                correct = sel.length === curQ.ans.length && sel.every(v => curQ.ans.includes(v));
            } else if(curQ.type === "editing") {
                let s1 = document.getElementById('s1').value;
                let s2 = document.getElementById('s2').value;
                correct = (s1 === curQ.ans[0] && s2 === curQ.ans[1]);
            }

            updateScore(correct);
            if(correct) setTimeout(next, 1500);
        }
        
        window.onload = next;
    </script>
</body>
</html>
