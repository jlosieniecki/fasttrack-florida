<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FAST Grade 3 Math Mastery</title>
    <style>
        :root { --header: #2C3E50; --bg: #F5F7FA; --active: #00609C; --text: #333; --bubble-border: #999; }
        
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            background: var(--bg); 
            margin: 0; 
            height: 100dvh; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
        }

        /* --- SCREENS --- */
        .screen { display: none; height: 100%; width: 100%; flex-direction: column; }
        .screen.active { display: flex; }

        /* --- MENU --- */
        .menu-container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; background: linear-gradient(135deg, #003057, #005085); color: white; padding: 20px; }
        .menu-card { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); text-align: center; color: #333; width: 100%; max-width: 600px; max-height: 90vh; overflow-y: auto; }
        .menu-btn { display: block; width: 100%; padding: 18px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; font-size: 1.1em; cursor: pointer; transition: 0.2s; background: #fff; text-align: left; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .menu-btn:hover { background: #f0f8ff; border-color: var(--active); transform: translateX(5px); }
        .menu-btn strong { display: block; color: #003057; }

        /* --- TEST INTERFACE --- */
        .top-bar { background: #fff; border-bottom: 1px solid #ccc; color: #333; padding: 0 15px; height: 50px; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
        .tool-btn { background: transparent; border: 1px solid #ccc; color: #555; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 0.85em; margin-left:5px;}
        .tool-btn:hover { background: #eee; }

        .main-stage { flex: 1; padding: 15px; overflow: hidden; display: flex; gap: 15px; height: 100%; position: relative; }
        .pane { background: white; border-radius: 2px; padding: 25px; overflow-y: auto; border: 1px solid #ccc; height: 100%; box-sizing: border-box; }
        
        .left-pane { width: 40%; background: #FAFAFA; border-right: 1px solid #ccc; display: flex; align-items: center; justify-content: center; padding: 20px; }
        .right-pane { width: 60%; }
        @media (max-width: 768px) {
            .main-stage { flex-direction: column; padding: 10px; }
            .left-pane { width: 100%; height: 35%; border-right: none; border-bottom: 2px solid #ccc; padding: 10px; }
            .right-pane { width: 100%; height: 65%; padding: 15px; }
            .pane { padding: 15px; }
        }

        /* TYPOGRAPHY & VISUALS */
        .q-header { color: #666; font-weight: bold; margin-bottom: 15px; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .q-text { font-size: 1.25em; line-height: 1.6; color: #000; margin-bottom: 25px; font-family: 'Times New Roman', serif; }
        svg { width: 100%; height: auto; max-height: 280px; display: block; margin: 0 auto; }

        /* --- SPECIAL ITEM STYLES --- */
        .inline-select { display: inline-block; font-size: 1em; padding: 4px 8px; margin: 0 4px; border: 1px solid #333; border-radius: 4px; background: #fff; color: #000; font-family: 'Arial', sans-serif; font-weight: bold; cursor: pointer; }
        .shading-box-container { background: #f4f4f4; padding: 15px; border: 1px solid #ccc; border-radius: 4px; display: inline-block; min-width: 250px; }
        .input-row { display: flex; align-items: center; margin-bottom: 10px; justify-content: space-between; }
        .input-row label { font-weight: bold; margin-right: 10px; }
        .input-box { font-size: 1.2em; padding: 8px; width: 100px; text-align: center; border: 1px solid #999; background: white; border-radius: 4px; }
        
        /* TABLE MATCH */
        .match-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .match-table th, .match-table td { border: 1px solid #ddd; padding: 12px; text-align: center; font-size: 1.1em; }
        .match-table th { background: #f5f5f5; color: #555; }

        /* STANDARD CHOICE */
        .opt-row { display: flex; padding: 14px; margin-bottom: 10px; cursor: pointer; align-items: center; transition:0.1s; border: 1px solid transparent; border-radius: 4px; }
        .opt-row:hover { background: #f9f9f9; border-color: #ddd; }
        .opt-row.selected { background: #E3F2FD; border-color: #00609C; font-weight: bold; }
        .bubble { width: 22px; height: 22px; border: 1px solid #000; border-radius: 50%; margin-right: 15px; flex-shrink: 0; background: white; }
        .bubble.square { border-radius: 2px; }
        .opt-row.selected .bubble { background: #000; border-color: #000; }

        /* FOOTER */
        .nav-bar { background: #f8f8f8; border-top: 1px solid #ccc; height: 60px; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; flex-shrink: 0; }
        .nav-btn { background: var(--active); color: white; border: none; padding: 10px 25px; border-radius: 4px; font-size: 1em; font-weight: bold; cursor: pointer; min-width: 90px; }
        
        /* REPORT */
        .score-badge { display: inline-block; padding: 8px 16px; border-radius: 20px; font-weight: bold; color: white; margin: 10px; font-size: 1.2em; }
        .level-5 { background: #00796B; } .level-4 { background: #388E3C; } .level-3 { background: #FBC02D; color: #000; } .level-2 { background: #F57C00; } .level-1 { background: #D32F2F; }
        .strength-grid { display: grid; grid-template-columns: 1fr; gap: 10px; text-align: left; }
        .stat-row { display: flex; justify-content: space-between; padding: 12px; background: #f9f9f9; border-radius: 6px; border-left: 5px solid #ccc; }
        .stat-good { border-left-color: #388E3C; } .stat-bad { border-left-color: #D32F2F; }
    </style>
</head>
<body>

    <div id="screen-menu" class="screen active">
        <div class="menu-container">
            <div class="menu-card">
                <img src="Gemini_Generated_Image_t8043ht8043ht804.png" style="width:70px; border-radius:10px; margin-bottom:15px;" alt="Logo">
                <h2 style="margin:0;">FAST Math Portal</h2>
                <p style="color:#666; margin-bottom:20px;">Official Item Style Generator</p>
                
                <button class="menu-btn" onclick="initSession('ALL', 35)">
                    <strong>üöÄ Full FAST Simulation</strong>
                    <small>35 Items ‚Ä¢ All Domains ‚Ä¢ Weighted Scoring</small>
                </button>
                <button class="menu-btn" onclick="initSession('FR', 15)">
                    <strong>üçï Fractions Domain</strong>
                    <small>15 Items ‚Ä¢ Visual Models & Comparisons</small>
                </button>
                <button class="menu-btn" onclick="initSession('NSO', 20)">
                    <strong>üî¢ Number Sense & Ops</strong>
                    <small>20 Items ‚Ä¢ Multi-Step & Place Value</small>
                </button>
                <button class="menu-btn" onclick="initSession('GR', 15)">
                    <strong>üìê Geometry & Data</strong>
                    <small>15 Items ‚Ä¢ Area, Perimeter & Graphs</small>
                </button>
                <button class="menu-btn" onclick="initSession('AR', 15)">
                    <strong>üß† Algebraic Reasoning</strong>
                    <small>15 Items ‚Ä¢ Logic, Patterns & Missing Factors</small>
                </button>
            </div>
        </div>
    </div>

    <div id="screen-test" class="screen">
        <div class="top-bar">
            <div><strong>Student: Guest</strong> | <span id="session-label">Test</span></div>
            <div>
                <button class="tool-btn" onclick="toggleZoom()">üîç Zoom</button>
                <button class="tool-btn" onclick="alert('Reference Sheet:\n\n1 ft = 12 in\n1 yd = 3 ft\n1 min = 60 sec\n1 hr = 60 min')">üìÑ Formulas</button>
                <button class="tool-btn" style="background:#C0392B; color:white; border:none;" onclick="location.reload()">Exit</button>
            </div>
        </div>

        <div id="stage" class="main-stage"></div>

        <div class="nav-bar">
            <button class="nav-btn" style="background:white; color:#333; border:1px solid #ccc;" onclick="prevQ()">Back</button>
            <div style="font-weight:bold; color:#555;">Item <span id="q-idx">1</span> of <span id="q-total">35</span></div>
            <button id="btn-next" class="nav-btn" onclick="nextQ()">Next</button>
        </div>
    </div>

    <div id="screen-report" class="screen">
        <div class="menu-container" style="background: #f4f4f4; color: #333;">
            <div class="menu-card" style="width: 100%; max-width: 600px;">
                <h1 style="margin:0;">Performance Report</h1>
                <div id="final-badge" class="level-badge lvl-3">Level 3</div>
                <p id="final-msg" style="margin-top:5px; color:#666;">On Grade Level</p>
                <div id="report-grid" class="strength-grid"></div>
                <button class="menu-btn" style="margin-top:20px; text-align:center; background:var(--active); color:white;" onclick="location.reload()">Return to Menu</button>
            </div>
        </div>
    </div>

    <script>
        // --- DYNAMIC VISUAL BUILDERS (Fixes "Incorrect Image" issues) ---
        
        function drawPie(d, shaded) {
            // Draws a dynamic pie chart with 'd' slices and 'shaded' slices filled
            let path = "";
            let rad = 45;
            if(d === 1) return `<svg viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="#3498DB" stroke="#333" stroke-width="2"/></svg>`;
            
            // Generate sectors
            let sector = 360/d;
            let dPath = "";
            for(let i=0; i<shaded; i++) {
                let startA = (i*sector) * (Math.PI/180);
                let endA = ((i+1)*sector) * (Math.PI/180);
                let x1 = 50 + rad*Math.sin(startA), y1 = 50 - rad*Math.cos(startA);
                let x2 = 50 + rad*Math.sin(endA), y2 = 50 - rad*Math.cos(endA);
                dPath += `M50,50 L${x1},${y1} A${rad},${rad} 0 0,1 ${x2},${y2} Z `;
            }

            // Lines
            let lines = "";
            for(let i=0; i<d; i++) {
                let ang = (i*sector) * (Math.PI/180);
                let x = 50 + rad*Math.sin(ang), y = 50 - rad*Math.cos(ang);
                lines += `<line x1="50" y1="50" x2="${x}" y2="${y}" stroke="#333" stroke-width="2"/>`;
            }

            return `<svg viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45" fill="white" stroke="#333" stroke-width="2"/>
                <path d="${dPath}" fill="#3498DB" stroke="#333" stroke-width="1"/>
                ${lines}
            </svg>`;
        }

        function drawRect(l, w) {
            return `<svg viewBox="0 0 300 150">
                <rect x="50" y="25" width="200" height="100" fill="#EAEAEA" stroke="#333" stroke-width="3"/>
                <text x="150" y="20" text-anchor="middle" font-weight="bold" font-size="16">${l} units</text>
                <text x="150" y="145" text-anchor="middle" font-weight="bold" font-size="16">${l} units</text>
                <text x="35" y="80" text-anchor="middle" font-weight="bold" font-size="16" transform="rotate(-90,35,80)">${w} units</text>
                <text x="265" y="80" text-anchor="middle" font-weight="bold" font-size="16" transform="rotate(90,265,80)">${w} units</text>
            </svg>`;
        }

        function drawClock(h, m) {
            let mAng = m * 6;
            let hAng = (h % 12) * 30 + (m * 0.5);
            return `<svg viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45" fill="white" stroke="#333" stroke-width="3"/>
                <text x="50" y="15" text-anchor="middle" font-size="10">12</text>
                <text x="85" y="53" text-anchor="middle" font-size="10">3</text>
                <text x="50" y="92" text-anchor="middle" font-size="10">6</text>
                <text x="15" y="53" text-anchor="middle" font-size="10">9</text>
                <line x1="50" y1="50" x2="${50 + 25*Math.sin(hAng*Math.PI/180)}" y2="${50 - 25*Math.cos(hAng*Math.PI/180)}" stroke="black" stroke-width="3"/>
                <line x1="50" y1="50" x2="${50 + 35*Math.sin(mAng*Math.PI/180)}" y2="${50 - 35*Math.cos(mAng*Math.PI/180)}" stroke="black" stroke-width="2"/>
            </svg>`;
        }

        // --- EXPANDED GENERATORS ---
        const GENERATORS = {
            NSO: [
                () => { // VARIATION 1: Expanded Form
                    let n = 1000 + Math.floor(Math.random()*8999);
                    let th=Math.floor(n/1000)*1000, h=Math.floor((n%1000)/100)*100, t=Math.floor((n%100)/10)*10, o=n%10;
                    return { cat: "NSO", type: "choice", layout: "full", text: `What is the expanded form of <b>${n.toLocaleString()}</b>?`, opts: [`${th} + ${h} + ${t} + ${o}`, `${th} + ${h}0 + ${t} + ${o}`, `${Math.floor(n/1000)} + ${Math.floor((n%1000)/100)} + ${Math.floor((n%100)/10)} + ${o}`].sort(()=>Math.random()-0.5), ans: `${th} + ${h} + ${t} + ${o}` };
                },
                () => { // VARIATION 2: Multi-Input Addition
                    let total = Math.floor(Math.random()*200)+100;
                    let p1 = Math.floor(Math.random()*50)+20;
                    return { cat: "NSO", type: "multi-input", layout: "full", text: `The total is <b>${total}</b>. One part is <b>${p1}</b>. What is the other part?`, inputs:[{label:"Part 1:",val:p1,lock:true},{label:"Part 2:",val:"",correct:(total-p1).toString()}], ans: (total-p1).toString() };
                },
                () => { // VARIATION 3: Rounding
                    let n = Math.floor(Math.random()*800)+123;
                    return { cat: "NSO", type: "choice", layout: "full", text: `Round <b>${n}</b> to the nearest ten.`, opts: [(Math.floor(n/10)*10).toString(), (Math.ceil(n/10)*10).toString(), (Math.round(n/100)*100).toString()].sort(()=>Math.random()-0.5), ans: (Math.round(n/10)*10).toString() };
                },
                () => { // VARIATION 4: Word Problem Mult
                    let items = ["stickers", "cards", "cookies", "toys"];
                    let item = items[Math.floor(Math.random()*items.length)];
                    let a = Math.floor(Math.random()*7)+3, b = Math.floor(Math.random()*8)+2;
                    return { cat: "NSO", type: "input", layout: "full", text: `Sam has ${a} packs of ${item}. Each pack has ${b} ${item}. How many total?`, ans: (a*b).toString() };
                }
            ],
            FR: [
                () => { // VARIATION 1: Visual Identification
                    let d = [3,4,6,8][Math.floor(Math.random()*4)];
                    return { cat: "FR", type: "choice", layout: "split", visual: drawPie(d, 1), text: `Which fraction represents the shaded part?`, opts: [`1/${d}`, `1/${d+1}`, `${d}/1`], ans: `1/${d}` };
                },
                () => { // VARIATION 2: Compare Fractions (Inline)
                    let d = [4,6,8][Math.floor(Math.random()*3)];
                    return { cat: "FR", type: "inline", layout: "full", text: "Compare the fractions.", sentence: [{text:"1/2 is "},{type:"select",opts:["greater than","less than","equal to"],ans:"greater than"},{text:` 1/${d} because the parts are `},{type:"select",opts:["larger","smaller"],ans:"larger"},{text:"."}] };
                },
                () => { // VARIATION 3: Number Line
                    return { cat: "FR", type: "choice", layout: "split", visual: `<svg viewBox="0 0 300 50"><line x1="10" y1="25" x2="290" y2="25" stroke="black"/><circle cx="150" cy="25" r="6" fill="#3498DB"/><text x="10" y="45">0</text><text x="290" y="45">1</text></svg>`, text: "The dot is halfway between 0 and 1. What fraction is it?", opts: ["1/2", "1/4", "1/8"], ans: "1/2" };
                }
            ],
            GR: [
                () => { // VARIATION 1: Find Area
                    let l = Math.floor(Math.random()*8)+3, w = Math.floor(Math.random()*5)+2;
                    return { cat: "GR", type: "input", layout: "split", visual: drawRect(l, w), text: "Calculate the Area of the rectangle.", ans: (l*w).toString() };
                },
                () => { // VARIATION 2: Find Perimeter
                    let l = Math.floor(Math.random()*8)+3, w = Math.floor(Math.random()*5)+2;
                    return { cat: "GR", type: "input", layout: "split", visual: drawRect(l, w), text: "Calculate the Perimeter of the rectangle.", ans: (2*l+2*w).toString() };
                },
                () => { // VARIATION 3: Time
                    let h = Math.floor(Math.random()*11)+1, m = [0,15,30,45][Math.floor(Math.random()*4)];
                    return { cat: "GR", type: "choice", layout: "split", visual: drawClock(h, m), text: "What time is shown on the clock?", opts: [`${h}:${m===0?'00':m}`, `${h+1}:${m===0?'00':m}`, `${h}:${m+15}`], ans: `${h}:${m===0?'00':m}` };
                }
            ],
            AR: [
                () => { // VARIATION 1: Logic Even/Odd
                    let n = Math.floor(Math.random()*40)*2;
                    return { cat: "AR", type: "inline", layout: "full", text: "Complete the sentence.", sentence: [{text:`${n} is `},{type:"select",opts:["even","odd"],ans:"even"},{text:" because it "},{type:"select",opts:["can","cannot"],ans:"can"},{text:" be paired evenly."}] };
                },
                () => { // VARIATION 2: Missing Factor
                    let a = Math.floor(Math.random()*9)+2, b = Math.floor(Math.random()*9)+2;
                    return { cat: "AR", type: "input", layout: "full", text: `Find the missing number: ? √∑ ${a} = ${b}`, ans: (a*b).toString() };
                }
            ]
        };

        // --- ENGINE ---
        let sessionQ = [], curIdx = 0, userAnswers = [];

        function initSession(mode, count) {
            sessionQ = []; userAnswers = [];
            for(let i=0; i<count; i++) {
                let cat = mode === 'ALL' ? ['NSO','FR','AR','GR'][Math.floor(Math.random()*4)] : mode;
                let gens = GENERATORS[cat];
                if(gens) sessionQ.push(gens[Math.floor(Math.random() * gens.length)]());
            }
            curIdx = 0;
            document.getElementById('session-label').innerText = mode === 'ALL' ? "Full FAST Mock" : mode + " Domain";
            document.getElementById('q-total').innerText = count;
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-test').classList.add('active');
            renderQ();
        }

        function renderQ() {
            const q = sessionQ[curIdx];
            const stage = document.getElementById('stage');
            const ans = userAnswers[curIdx] || {};

            let left = q.layout === "split" ? `<div class="left-pane">${q.visual}</div>` : "";
            let rClass = q.layout === "split" ? "right-pane" : "right-pane";
            if(q.layout === 'full') left = "";

            let html = "";
            
            if(q.type === 'choice') {
                q.opts.forEach(o => {
                    let sel = ans === o ? 'selected' : '';
                    html += `<div class="opt-row ${sel}" onclick="save('${o}')"><div class="bubble"></div>${o}</div>`;
                });
            }
            else if (q.type === 'input') {
                html = `<input class="input-box" value="${ans||''}" onchange="save(this.value)" placeholder="?">`;
            }
            else if (q.type === 'multi-select') {
                q.opts.forEach((o, i) => {
                    let savedArr = userAnswers[curIdx] || [];
                    let sel = savedArr.includes(i) ? 'selected' : '';
                    html += `<div class="opt-row ${sel}" onclick="saveMulti(${i})"><div class="bubble square"></div>${o}</div>`;
                });
            }
            else if (q.type === 'multi-input') {
                html += `<div class="shading-box-container">`;
                q.inputs.forEach((inp, i) => {
                    let val = (inp.lock) ? inp.val : (ans[i] || "");
                    let lockAttr = inp.lock ? "disabled style='background:#eee; border-color:transparent'" : `onchange="saveMultiInput(${i}, this.value)"`;
                    html += `<div class="input-row"><label>${inp.label}</label><input class="input-box" value="${val}" ${lockAttr}></div>`;
                });
                html += `</div>`;
            }
            else if (q.type === 'inline') {
                html += `<div style="line-height:2.5;">`;
                q.sentence.forEach((part, idx) => {
                    if(part.type === 'select') {
                        let val = ans[idx] || "Select...";
                        html += `<select class="inline-select" onchange="saveInline(${idx}, this.value)"><option disabled selected>${val}</option>`;
                        part.opts.forEach(o => html += `<option value="${o}">${o}</option>`);
                        html += `</select>`;
                    } else {
                        html += `<span>${part.text}</span>`;
                    }
                });
                html += `</div>`;
            }

            stage.innerHTML = `
                ${left}
                <div class="pane ${q.layout==='full'?'':'right-pane'}" style="width:${q.layout==='full'?'100%':'60%'}">
                    <div class="q-header">${q.cat} ‚Ä¢ Item ${curIdx+1}</div>
                    <div class="q-text">${q.text}</div>
                    ${html}
                </div>
            `;
            document.getElementById('btn-next').innerText = (curIdx === sessionQ.length-1) ? "Finish" : "Next";
            document.getElementById('q-idx').innerText = curIdx + 1;
        }

        // --- SAVING ---
        window.save = (val) => { userAnswers[curIdx] = val; renderQ(); };
        window.saveMulti = (idx) => { 
            let arr = userAnswers[curIdx] || [];
            if(arr.includes(idx)) arr = arr.filter(x=>x!==idx); else arr.push(idx);
            userAnswers[curIdx] = arr; renderQ();
        };
        window.saveMultiInput = (idx, val) => { let cur = userAnswers[curIdx] || {}; cur[idx] = val; userAnswers[curIdx] = cur; };
        window.saveInline = (idx, val) => { let cur = userAnswers[curIdx] || {}; cur[idx] = val; userAnswers[curIdx] = cur; };

        window.nextQ = () => { if(curIdx < sessionQ.length-1) { curIdx++; renderQ(); } else { finishSession(); } };
        window.prevQ = () => { if(curIdx > 0) { curIdx--; renderQ(); } };
        window.toggleZoom = () => { document.body.style.zoom = document.body.style.zoom === "1.2" ? "1" : "1.2"; }

        function finishSession() {
            let score = 0;
            let stats = { NSO:{c:0,t:0}, FR:{c:0,t:0}, AR:{c:0,t:0}, GR:{c:0,t:0} };

            sessionQ.forEach((q, i) => {
                let ans = userAnswers[i];
                let isCorrect = false;

                if (q.type === 'choice' || q.type === 'input') isCorrect = (ans == q.ans);
                else if (q.type === 'multi-select') {
                    if(ans && ans.length === q.ans.length && q.ans.every(v => ans.includes(v))) isCorrect = true;
                }
                else if (q.type === 'multi-input') isCorrect = (ans[1] === q.ans);
                else if (q.type === 'inline') {
                    isCorrect = true;
                    q.sentence.forEach((p, idx) => { if(p.type==='select' && ans[idx]!==p.ans) isCorrect=false; });
                }

                if(!stats[q.cat]) stats[q.cat] = {c:0,t:0};
                stats[q.cat].t++;
                if(isCorrect) { score++; stats[q.cat].c++; }
            });

            // REPORT
            let pct = Math.round((score / sessionQ.length) * 100);
            let lvl = 1, txt = "Level 1", cls = "lvl-1", msg = "Intervention Needed";
            if(pct >= 40) { lvl=2; txt="Level 2"; cls="lvl-2"; msg="Below Satisfactory"; }
            if(pct >= 60) { lvl=3; txt="Level 3"; cls="lvl-3"; msg="On Grade Level"; }
            if(pct >= 80) { lvl=4; txt="Level 4"; cls="lvl-4"; msg="Proficient"; }
            if(pct >= 90) { lvl=5; txt="Level 5"; cls="lvl-5"; msg="Mastery!"; }

            document.getElementById('final-badge').className = "level-badge " + cls;
            document.getElementById('final-badge').innerText = txt;
            document.getElementById('final-msg').innerText = `${msg} (${pct}%)`;

            let html = "";
            for(let k in stats) {
                if(stats[k].t === 0) continue;
                let sPct = Math.round((stats[k].c / stats[k].t) * 100);
                let status = sPct >= 60 ? "stat-good" : "stat-bad";
                let label = sPct >= 60 ? "‚úÖ Strength" : "‚ö†Ô∏è Needs Practice";
                html += `<div class="stat-row ${status}"><div><strong>${k}</strong></div><div>${stats[k].c}/${stats[k].t} (${sPct}%)</div><div>${label}</div></div>`;
            }
            document.getElementById('report-grid').innerHTML = html;
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-report').classList.add('active');
        }
    </script>
</body>
</html>
